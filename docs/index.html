<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>StepSyncAI - Personal Health & Wellness Platform</title>
  <meta name="description" content="Track your mental health, medication, sleep, exercise, and get personalized wellness insights.">
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸ¥</text></svg>">
  <style>
    :root{--bg:#0f172a;--card:#1e293b;--card-hover:#273549;--accent:#3b82f6;--accent-2:#60a5fa;--success:#10b981;--warning:#f59e0b;--danger:#ef4444;--text:#f1f5f9;--muted:#94a3b8;--border:#334155;--radius:12px}
    *{box-sizing:border-box;margin:0;padding:0}
    body{font-family:'Inter',-apple-system,BlinkMacSystemFont,'Segoe UI',sans-serif;background:var(--bg);color:var(--text);line-height:1.6;min-height:100vh}
    .container{max-width:1200px;margin:0 auto;padding:1rem}

    /* Header */
    header{background:var(--card);border-bottom:1px solid var(--border);padding:1rem 0;position:sticky;top:0;z-index:100}
    .header-content{display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:1rem}
    .logo{display:flex;align-items:center;gap:.75rem;font-size:1.5rem;font-weight:800;color:var(--accent);text-decoration:none}
    .badge{background:var(--success);color:#fff;padding:.25rem .75rem;border-radius:999px;font-size:.75rem;font-weight:600}

    /* Navigation Tabs */
    .nav-tabs{display:flex;gap:.5rem;flex-wrap:wrap}
    .nav-tab{background:transparent;border:1px solid var(--border);color:var(--muted);padding:.5rem 1rem;border-radius:8px;cursor:pointer;font-weight:600;transition:all .2s;font-size:.875rem}
    .nav-tab:hover{border-color:var(--accent);color:var(--accent)}
    .nav-tab.active{background:var(--accent);color:#fff;border-color:var(--accent)}
    .nav-tab .icon{margin-right:.5rem}

    /* Main Content */
    main{padding:1.5rem 0}
    .app-section{display:none}
    .app-section.active{display:block}

    /* Cards */
    .card{background:var(--card);border:1px solid var(--border);border-radius:var(--radius);padding:1.5rem;margin-bottom:1.5rem}
    .card-title{font-size:1.25rem;font-weight:700;margin-bottom:1rem;display:flex;align-items:center;gap:.5rem}

    /* Forms */
    .form-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:1rem}
    .form-group{margin-bottom:1rem}
    .form-group label{display:block;font-weight:600;margin-bottom:.5rem;color:var(--muted);font-size:.875rem}
    input,select,textarea{width:100%;padding:.75rem;border:1px solid var(--border);border-radius:8px;background:var(--bg);color:var(--text);font-size:1rem}
    input:focus,select:focus,textarea:focus{outline:none;border-color:var(--accent)}
    input[type="range"]{padding:0}

    /* Buttons */
    .btn{padding:.75rem 1.5rem;border-radius:8px;font-weight:700;cursor:pointer;transition:all .2s;border:none;font-size:.9rem}
    .btn-primary{background:var(--accent);color:#fff}
    .btn-primary:hover{background:var(--accent-2)}
    .btn-success{background:var(--success);color:#fff}
    .btn-danger{background:var(--danger);color:#fff}
    .btn-secondary{background:var(--card);color:var(--text);border:1px solid var(--border)}
    .btn-group{display:flex;gap:.5rem;flex-wrap:wrap;margin-top:1rem}

    /* Mood Slider */
    .mood-display{font-size:3rem;text-align:center;margin:1rem 0}
    .mood-scale{display:flex;justify-content:space-between;font-size:.75rem;color:var(--muted);margin-top:.5rem}

    /* Wellness Score */
    .wellness-score{text-align:center;padding:2rem;background:linear-gradient(135deg,var(--card) 0%,var(--bg) 100%);border-radius:var(--radius);margin-bottom:1.5rem}
    .score-circle{width:150px;height:150px;border-radius:50%;display:flex;align-items:center;justify-content:center;margin:0 auto 1rem;font-size:2.5rem;font-weight:800;border:8px solid var(--border)}
    .score-good{border-color:var(--success);color:var(--success)}
    .score-medium{border-color:var(--warning);color:var(--warning)}
    .score-low{border-color:var(--danger);color:var(--danger)}
    .score-label{font-size:1.25rem;color:var(--muted)}

    /* Progress Bars */
    .progress-bar{background:var(--border);border-radius:999px;height:12px;margin:.5rem 0;overflow:hidden}
    .progress-fill{height:100%;border-radius:999px;transition:width .3s}
    .progress-fill.good{background:var(--success)}
    .progress-fill.medium{background:var(--warning)}
    .progress-fill.low{background:var(--danger)}

    /* Data List */
    .data-list{max-height:300px;overflow-y:auto}
    .data-item{background:var(--bg);padding:1rem;border-radius:8px;margin-bottom:.5rem;display:flex;justify-content:space-between;align-items:center}
    .data-item-info{flex:1}
    .data-item-title{font-weight:600}
    .data-item-meta{font-size:.875rem;color:var(--muted)}
    .data-item-value{font-size:1.25rem;font-weight:700}

    /* Stats Grid */
    .stats-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(150px,1fr));gap:1rem;margin-bottom:1.5rem}
    .stat-card{background:var(--bg);padding:1rem;border-radius:8px;text-align:center}
    .stat-value{font-size:1.75rem;font-weight:800;color:var(--accent)}
    .stat-label{font-size:.75rem;color:var(--muted);margin-top:.25rem}

    /* Medication Grid */
    .med-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:1rem}
    .med-card{background:var(--bg);padding:1rem;border-radius:8px;border-left:4px solid var(--accent)}
    .med-card.taken{border-left-color:var(--success);opacity:.7}
    .med-card.missed{border-left-color:var(--danger)}
    .med-name{font-weight:700;font-size:1.1rem}
    .med-time{color:var(--muted);font-size:.875rem}

    /* Quiz */
    .quiz-question{font-size:1.25rem;margin-bottom:1.5rem}
    .quiz-options{display:grid;gap:.75rem}
    .quiz-option{background:var(--bg);padding:1rem;border-radius:8px;cursor:pointer;border:2px solid var(--border);transition:all .2s}
    .quiz-option:hover{border-color:var(--accent)}
    .quiz-option.correct{border-color:var(--success);background:rgba(16,185,129,.1)}
    .quiz-option.incorrect{border-color:var(--danger);background:rgba(239,68,68,.1)}
    .quiz-option.selected{border-color:var(--accent)}

    /* Insights */
    .insight{background:var(--bg);padding:1rem;border-radius:8px;margin-bottom:.75rem;border-left:4px solid var(--accent)}
    .insight.positive{border-left-color:var(--success)}
    .insight.warning{border-left-color:var(--warning)}
    .insight.negative{border-left-color:var(--danger)}

    /* Responsive */
    @media(max-width:768px){
      .nav-tabs{justify-content:center}
      .nav-tab span:not(.icon){display:none}
      .header-content{justify-content:center}
      .stats-grid{grid-template-columns:repeat(2,1fr)}
    }

    /* Footer */
    footer{background:var(--card);border-top:1px solid var(--border);padding:2rem 0;margin-top:3rem}
    .footer-content{max-width:1200px;margin:0 auto;padding:0 1rem;display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:1.5rem}
    .footer-left{display:flex;flex-direction:column;gap:.5rem}
    .footer-title{font-size:1.25rem;font-weight:700;color:var(--accent)}
    .footer-subtitle{color:var(--muted);font-size:.9rem}
    .footer-right{display:flex;gap:1rem;align-items:center;flex-wrap:wrap}
    .footer-link{display:inline-flex;align-items:center;gap:.5rem;padding:.5rem 1rem;background:var(--bg);border:1px solid var(--border);border-radius:8px;color:var(--text);text-decoration:none;font-weight:600;transition:all .2s;font-size:.9rem}
    .footer-link:hover{border-color:var(--accent);color:var(--accent);transform:translateY(-2px)}
    .tech-badge{display:inline-block;padding:.25rem .75rem;background:var(--bg);border:1px solid var(--border);border-radius:6px;font-size:.75rem;color:var(--muted);font-weight:600}
    @media(max-width:768px){.footer-content{flex-direction:column;text-align:center}.footer-right{justify-content:center}}
  </style>


<body>
  <header>
    <div class="container">
      <div class="header-content">
        <a href="#" class="logo">ğŸ¥ StepSyncAI <span class="badge">LIVE</span></a>
        <nav class="nav-tabs">
          <button class="nav-tab active" data-tab="dashboard"><span class="icon">ğŸ“Š</span><span>Dashboard</span></button>
          <button class="nav-tab" data-tab="mental"><span class="icon">ğŸ§ </span><span>Mental Health</span></button>
          <button class="nav-tab" data-tab="medication"><span class="icon">ğŸ’Š</span><span>Medication</span></button>
          <button class="nav-tab" data-tab="sleep"><span class="icon">ğŸ˜´</span><span>Sleep</span></button>
          <button class="nav-tab" data-tab="exercise"><span class="icon">ğŸƒ</span><span>Exercise</span></button>
        </nav>
      </div>
    </div>
  </header>

  <main class="container">
    <!-- Dashboard -->
    <section id="dashboard" class="app-section active">
      <div class="wellness-score">
        <div class="score-circle score-medium" id="wellnessCircle">
          <span id="wellnessScore">--</span>
        </div>
        <div class="score-label">Overall Wellness Score</div>
      </div>

      <div class="stats-grid">
        <div class="stat-card"><div class="stat-value" id="statMood">--</div><div class="stat-label">Mood Today</div></div>
        <div class="stat-card"><div class="stat-value" id="statSleep">--</div><div class="stat-label">Hours Sleep</div></div>
        <div class="stat-card"><div class="stat-value" id="statExercise">--</div><div class="stat-label">Min Exercise</div></div>
        <div class="stat-card"><div class="stat-value" id="statMeds">--</div><div class="stat-label">Meds Taken</div></div>
      </div>

      <div class="card">
        <div class="card-title">ğŸ’¡ Today's Insights</div>
        <div id="insightsList">
          <div class="insight">Log your daily data to see personalized insights!</div>
        </div>
      </div>

      <div class="card">
        <div class="card-title">ğŸ“ˆ Weekly Progress</div>
        <div class="form-grid">
          <div>
            <label>ğŸ§  Mood</label>
            <div class="progress-bar"><div class="progress-fill good" id="progressMood" style="width:0%"></div></div>
          </div>
          <div>
            <label>ğŸ˜´ Sleep</label>
            <div class="progress-bar"><div class="progress-fill medium" id="progressSleep" style="width:0%"></div></div>
          </div>
          <div>
            <label>ğŸƒ Exercise</label>
            <div class="progress-bar"><div class="progress-fill low" id="progressExercise" style="width:0%"></div></div>
          </div>
          <div>
            <label>ğŸ’Š Medication</label>
            <div class="progress-bar"><div class="progress-fill good" id="progressMeds" style="width:0%"></div></div>
          </div>
        </div>
      </div>
    </section>

    <!-- Mental Health -->
    <section id="mental" class="app-section">
      <div class="card">
        <div class="card-title">ğŸ§  Log Your Mood</div>
        <div class="form-group">
          <label>How are you feeling today? (1-10)</label>
          <div class="mood-display" id="moodEmoji">ğŸ˜</div>
          <input type="range" id="moodSlider" min="1" max="10" value="5">
          <div class="mood-scale"><span>1 - Very Low</span><span>5 - Neutral</span><span>10 - Excellent</span></div>
        </div>
        <div class="form-group">
          <label>Any symptoms today?</label>
          <div class="btn-group">
            <button class="btn btn-secondary symptom-btn" data-symptom="anxiety">ğŸ˜° Anxiety</button>
            <button class="btn btn-secondary symptom-btn" data-symptom="stress">ğŸ˜« Stress</button>
            <button class="btn btn-secondary symptom-btn" data-symptom="fatigue">ğŸ˜´ Fatigue</button>
            <button class="btn btn-secondary symptom-btn" data-symptom="irritability">ğŸ˜¤ Irritability</button>
            <button class="btn btn-secondary symptom-btn" data-symptom="hopeful">ğŸŒŸ Hopeful</button>
          </div>
        </div>
        <div class="form-group">
          <label>Notes (optional)</label>
          <textarea id="moodNotes" rows="3" placeholder="How was your day?"></textarea>
        </div>
        <button class="btn btn-primary" onclick="saveMood()">ğŸ’¾ Save Mood Entry</button>
      </div>

      <div class="card">
        <div class="card-title">ğŸ“… Recent Entries</div>
        <div class="data-list" id="moodHistory"></div>
      </div>
    </section>

    <!-- Medication -->
    <section id="medication" class="app-section">
      <div class="card">
        <div class="card-title">ğŸ’Š Add Medication</div>
        <div class="form-grid">
          <div class="form-group">
            <label>Medication Name</label>
            <input type="text" id="medName" placeholder="e.g., Vitamin D">
          </div>
          <div class="form-group">
            <label>Dosage</label>
            <input type="text" id="medDosage" placeholder="e.g., 1000 IU">
          </div>
          <div class="form-group">
            <label>Time</label>
            <select id="medTime">
              <option value="morning">ğŸŒ… Morning</option>
              <option value="afternoon">â˜€ï¸ Afternoon</option>
              <option value="evening">ğŸŒ† Evening</option>
              <option value="night">ğŸŒ™ Night</option>
            </select>
          </div>
        </div>
        <button class="btn btn-primary" onclick="addMedication()">â• Add Medication</button>
      </div>

      <div class="card">
        <div class="card-title">ğŸ“‹ Today's Medications</div>
        <div class="med-grid" id="medList"></div>
      </div>

      <div class="card">
        <div class="card-title">âš ï¸ Interaction Warnings</div>
        <div id="interactionWarnings">
          <div class="insight positive">No dangerous interactions detected.</div>
        </div>
      </div>
    </section>

    <!-- Sleep -->
    <section id="sleep" class="app-section">
      <div class="card">
        <div class="card-title">ğŸ˜´ Log Sleep</div>
        <div class="form-grid">
          <div class="form-group">
            <label>Bedtime</label>
            <input type="time" id="sleepBedtime" value="22:00">
          </div>
          <div class="form-group">
            <label>Wake Time</label>
            <input type="time" id="sleepWake" value="06:00">
          </div>
          <div class="form-group">
            <label>Sleep Quality (1-10)</label>
            <input type="range" id="sleepQuality" min="1" max="10" value="7">
            <div class="mood-scale"><span>Poor</span><span>Average</span><span>Excellent</span></div>
          </div>
        </div>
        <button class="btn btn-primary" onclick="saveSleep()">ğŸ’¾ Save Sleep Entry</button>
      </div>

      <div class="stats-grid">
        <div class="stat-card"><div class="stat-value" id="avgSleep">--</div><div class="stat-label">Avg Hours</div></div>
        <div class="stat-card"><div class="stat-value" id="avgQuality">--</div><div class="stat-label">Avg Quality</div></div>
        <div class="stat-card"><div class="stat-value" id="sleepDebt">--</div><div class="stat-label">Sleep Debt</div></div>
        <div class="stat-card"><div class="stat-value" id="sleepStreak">--</div><div class="stat-label">Day Streak</div></div>
      </div>

      <div class="card">
        <div class="card-title">ğŸ“… Sleep History</div>
        <div class="data-list" id="sleepHistory"></div>
      </div>
    </section>

    <!-- Exercise -->
    <section id="exercise" class="app-section">
      <div class="card">
        <div class="card-title">ğŸƒ Log Exercise</div>
        <div class="form-grid">
          <div class="form-group">
            <label>Activity Type</label>
            <select id="exerciseType">
              <option value="walking">ğŸš¶ Walking</option>
              <option value="running">ğŸƒ Running</option>
              <option value="cycling">ğŸš´ Cycling</option>
              <option value="swimming">ğŸŠ Swimming</option>
              <option value="gym">ğŸ‹ï¸ Gym/Weights</option>
              <option value="yoga">ğŸ§˜ Yoga</option>
              <option value="sports">âš½ Sports</option>
              <option value="other">âœ¨ Other</option>
            </select>
          </div>
          <div class="form-group">
            <label>Duration (minutes)</label>
            <input type="number" id="exerciseDuration" placeholder="30" min="1">
          </div>
          <div class="form-group">
            <label>Intensity</label>
            <select id="exerciseIntensity">
              <option value="light">ğŸ˜Œ Light</option>
              <option value="moderate">ğŸ’ª Moderate</option>
              <option value="intense">ğŸ”¥ Intense</option>
            </select>
          </div>
        </div>
        <button class="btn btn-primary" onclick="saveExercise()">ğŸ’¾ Log Exercise</button>
      </div>

      <div class="stats-grid">
        <div class="stat-card"><div class="stat-value" id="todayExercise">0</div><div class="stat-label">Min Today</div></div>
        <div class="stat-card"><div class="stat-value" id="weekExercise">0</div><div class="stat-label">Min This Week</div></div>
        <div class="stat-card"><div class="stat-value" id="exerciseGoal">30</div><div class="stat-label">Daily Goal</div></div>
        <div class="stat-card"><div class="stat-value" id="exerciseStreak">0</div><div class="stat-label">Day Streak</div></div>
      </div>

      <div class="card">
        <div class="card-title">ğŸ“… Exercise History</div>
        <div class="data-list" id="exerciseHistory"></div>
      </div>
    </section>

  </main>

  <footer>
    <div class="footer-content">
      <div class="footer-left">
        <div class="footer-title">ğŸ¥ StepSyncAI</div>
        <div class="footer-subtitle">Built by Ihab Saloum â€¢ Open Source Project</div>
        <div style="display:flex;gap:.5rem;margin-top:.5rem;flex-wrap:wrap">
          <span class="tech-badge">Node.js</span>
          <span class="tech-badge">JavaScript</span>
          <span class="tech-badge">HTML5</span>
          <span class="tech-badge">1,927 Tests</span>
          <span class="tech-badge">82% Coverage</span>
        </div>
      </div>
      <div class="footer-right">
        <a href="https://github.com/Isaloum/StepSyncAI" target="_blank" class="footer-link">
          <svg width="20" height="20" fill="currentColor" viewBox="0 0 24 24"><path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/></svg>
          View Source Code
        </a>
        <a href="https://github.com/Isaloum" target="_blank" class="footer-link">
          More Projects â†’
        </a>
      </div>
    </div>
  </footer>

  <script>
    // Data Storage
    const DB = {
      get: (key) => JSON.parse(localStorage.getItem('stepsync_' + key) || '[]'),
      set: (key, data) => localStorage.setItem('stepsync_' + key, JSON.stringify(data)),
      getOne: (key) => JSON.parse(localStorage.getItem('stepsync_' + key) || 'null'),
      setOne: (key, data) => localStorage.setItem('stepsync_' + key, JSON.stringify(data))
    };

    // Tab Navigation
    document.querySelectorAll('.nav-tab').forEach(tab => {
      tab.addEventListener('click', () => {
        document.querySelectorAll('.nav-tab').forEach(t => t.classList.remove('active'));
        document.querySelectorAll('.app-section').forEach(s => s.classList.remove('active'));
        tab.classList.add('active');
        document.getElementById(tab.dataset.tab).classList.add('active');
      });
    });

    // Mood Tracker
    const moodEmojis = ['ğŸ˜¢','ğŸ˜','ğŸ˜”','ğŸ˜•','ğŸ˜','ğŸ™‚','ğŸ˜Š','ğŸ˜„','ğŸ˜','ğŸ¤©'];
    const moodSlider = document.getElementById('moodSlider');
    const moodEmoji = document.getElementById('moodEmoji');
    let selectedSymptoms = [];

    moodSlider.addEventListener('input', () => {
      moodEmoji.textContent = moodEmojis[parseInt(moodSlider.value) - 1];
    });

    document.querySelectorAll('.symptom-btn').forEach(btn => {
      btn.addEventListener('click', () => {
        btn.classList.toggle('btn-primary');
        btn.classList.toggle('btn-secondary');
        const symptom = btn.dataset.symptom;
        if (selectedSymptoms.includes(symptom)) {
          selectedSymptoms = selectedSymptoms.filter(s => s !== symptom);
        } else {
          selectedSymptoms.push(symptom);
        }
      });
    });

    function saveMood() {
      const entry = {
        date: new Date().toISOString(),
        mood: parseInt(moodSlider.value),
        symptoms: [...selectedSymptoms],
        notes: document.getElementById('moodNotes').value
      };
      const moods = DB.get('moods');
      moods.unshift(entry);
      DB.set('moods', moods.slice(0, 100));
      document.getElementById('moodNotes').value = '';
      selectedSymptoms = [];
      document.querySelectorAll('.symptom-btn').forEach(b => {
        b.classList.remove('btn-primary');
        b.classList.add('btn-secondary');
      });
      alert('Mood saved! ğŸ‰');
      loadMoodHistory();
      updateDashboard();
    }

    function loadMoodHistory() {
      const moods = DB.get('moods');
      const container = document.getElementById('moodHistory');
      if (moods.length === 0) {
        container.innerHTML = '<div class="insight">No mood entries yet. Start tracking!</div>';
        return;
      }
      container.innerHTML = moods.slice(0, 10).map(m => `
        <div class="data-item">
          <div class="data-item-info">
            <div class="data-item-title">${moodEmojis[m.mood - 1]} Mood: ${m.mood}/10</div>
            <div class="data-item-meta">${new Date(m.date).toLocaleDateString()} ${m.symptoms.length ? 'â€¢ ' + m.symptoms.join(', ') : ''}</div>
          </div>
        </div>
      `).join('');
    }

    // Medication Tracker
    function addMedication() {
      const name = document.getElementById('medName').value.trim();
      const dosage = document.getElementById('medDosage').value.trim();
      const time = document.getElementById('medTime').value;
      if (!name) return alert('Please enter medication name');

      const meds = DB.get('medications');
      meds.push({ id: Date.now(), name, dosage, time, taken: false });
      DB.set('medications', meds);
      document.getElementById('medName').value = '';
      document.getElementById('medDosage').value = '';
      loadMedications();
      checkInteractions();
    }

    function loadMedications() {
      const meds = DB.get('medications');
      const container = document.getElementById('medList');
      if (meds.length === 0) {
        container.innerHTML = '<div class="insight">No medications added yet.</div>';
        return;
      }
      container.innerHTML = meds.map(m => `
        <div class="med-card ${m.taken ? 'taken' : ''}">
          <div class="med-name">${m.name}</div>
          <div class="med-time">${m.dosage} â€¢ ${m.time}</div>
          <button class="btn ${m.taken ? 'btn-success' : 'btn-secondary'}" onclick="toggleMed(${m.id})" style="margin-top:.5rem">
            ${m.taken ? 'âœ… Taken' : 'â¬œ Mark Taken'}
          </button>
          <button class="btn btn-danger" onclick="deleteMed(${m.id})" style="margin-top:.5rem;margin-left:.5rem">ğŸ—‘ï¸</button>
        </div>
      `).join('');
      updateDashboard();
    }

    function toggleMed(id) {
      const meds = DB.get('medications');
      const med = meds.find(m => m.id === id);
      if (med) med.taken = !med.taken;
      DB.set('medications', meds);
      loadMedications();
    }

    function deleteMed(id) {
      const meds = DB.get('medications').filter(m => m.id !== id);
      DB.set('medications', meds);
      loadMedications();
      checkInteractions();
    }

    const dangerousInteractions = [
      ['aspirin', 'ibuprofen', 'âš ï¸ Both are NSAIDs - increased bleeding risk'],
      ['warfarin', 'aspirin', 'ğŸš¨ High bleeding risk - consult doctor'],
      ['lisinopril', 'potassium', 'âš ï¸ Risk of hyperkalemia'],
      ['metformin', 'alcohol', 'âš ï¸ Risk of lactic acidosis'],
      ['ssri', 'maoi', 'ğŸš¨ Serotonin syndrome risk - dangerous!']
    ];

    function checkInteractions() {
      const meds = DB.get('medications').map(m => m.name.toLowerCase());
      const warnings = [];
      dangerousInteractions.forEach(([drug1, drug2, warning]) => {
        if (meds.some(m => m.includes(drug1)) && meds.some(m => m.includes(drug2))) {
          warnings.push(warning);
        }
      });
      const container = document.getElementById('interactionWarnings');
      if (warnings.length === 0) {
        container.innerHTML = '<div class="insight positive">âœ… No dangerous interactions detected.</div>';
      } else {
        container.innerHTML = warnings.map(w => `<div class="insight negative">${w}</div>`).join('');
      }
    }

    // Sleep Tracker
    function saveSleep() {
      const bedtime = document.getElementById('sleepBedtime').value;
      const wake = document.getElementById('sleepWake').value;
      const quality = parseInt(document.getElementById('sleepQuality').value);

      const bedDate = new Date(`2000-01-01T${bedtime}`);
      let wakeDate = new Date(`2000-01-01T${wake}`);
      if (wakeDate < bedDate) wakeDate.setDate(wakeDate.getDate() + 1);
      const hours = (wakeDate - bedDate) / (1000 * 60 * 60);

      const entry = { date: new Date().toISOString(), bedtime, wake, hours: Math.round(hours * 10) / 10, quality };
      const sleeps = DB.get('sleeps');
      sleeps.unshift(entry);
      DB.set('sleeps', sleeps.slice(0, 100));
      alert(`Sleep logged: ${entry.hours} hours, quality ${quality}/10`);
      loadSleepData();
      updateDashboard();
    }

    function loadSleepData() {
      const sleeps = DB.get('sleeps');
      const container = document.getElementById('sleepHistory');

      if (sleeps.length === 0) {
        container.innerHTML = '<div class="insight">No sleep data yet.</div>';
        document.getElementById('avgSleep').textContent = '--';
        document.getElementById('avgQuality').textContent = '--';
        document.getElementById('sleepDebt').textContent = '--';
        document.getElementById('sleepStreak').textContent = '--';
        return;
      }

      const avgHours = sleeps.reduce((a, s) => a + s.hours, 0) / sleeps.length;
      const avgQual = sleeps.reduce((a, s) => a + s.quality, 0) / sleeps.length;
      const debt = Math.max(0, (8 * 7) - sleeps.slice(0, 7).reduce((a, s) => a + s.hours, 0));

      document.getElementById('avgSleep').textContent = avgHours.toFixed(1);
      document.getElementById('avgQuality').textContent = avgQual.toFixed(1);
      document.getElementById('sleepDebt').textContent = debt.toFixed(1) + 'h';
      document.getElementById('sleepStreak').textContent = sleeps.length;

      container.innerHTML = sleeps.slice(0, 10).map(s => `
        <div class="data-item">
          <div class="data-item-info">
            <div class="data-item-title">${s.hours}h sleep, Quality: ${s.quality}/10</div>
            <div class="data-item-meta">${new Date(s.date).toLocaleDateString()} â€¢ ${s.bedtime} - ${s.wake}</div>
          </div>
        </div>
      `).join('');
    }

    // Exercise Tracker
    function saveExercise() {
      const type = document.getElementById('exerciseType').value;
      const duration = parseInt(document.getElementById('exerciseDuration').value) || 0;
      const intensity = document.getElementById('exerciseIntensity').value;
      if (duration <= 0) return alert('Please enter duration');

      const entry = { date: new Date().toISOString(), type, duration, intensity };
      const exercises = DB.get('exercises');
      exercises.unshift(entry);
      DB.set('exercises', exercises.slice(0, 100));
      document.getElementById('exerciseDuration').value = '';
      alert(`Logged ${duration} min of ${type}! ğŸ’ª`);
      loadExerciseData();
      updateDashboard();
    }

    function loadExerciseData() {
      const exercises = DB.get('exercises');
      const container = document.getElementById('exerciseHistory');
      const today = new Date().toDateString();
      const weekAgo = new Date(Date.now() - 7 * 24 * 60 * 60 * 1000);

      const todayMin = exercises.filter(e => new Date(e.date).toDateString() === today).reduce((a, e) => a + e.duration, 0);
      const weekMin = exercises.filter(e => new Date(e.date) > weekAgo).reduce((a, e) => a + e.duration, 0);

      document.getElementById('todayExercise').textContent = todayMin;
      document.getElementById('weekExercise').textContent = weekMin;

      if (exercises.length === 0) {
        container.innerHTML = '<div class="insight">No exercise logged yet.</div>';
        return;
      }

      const typeIcons = { walking: 'ğŸš¶', running: 'ğŸƒ', cycling: 'ğŸš´', swimming: 'ğŸŠ', gym: 'ğŸ‹ï¸', yoga: 'ğŸ§˜', sports: 'âš½', other: 'âœ¨' };
      container.innerHTML = exercises.slice(0, 10).map(e => `
        <div class="data-item">
          <div class="data-item-info">
            <div class="data-item-title">${typeIcons[e.type] || 'ğŸƒ'} ${e.type} - ${e.duration} min</div>
            <div class="data-item-meta">${new Date(e.date).toLocaleDateString()} â€¢ ${e.intensity} intensity</div>
          </div>
        </div>
      `).join('');
    }


    }

    function nextQuestion() {
      currentQuestionIndex = (currentQuestionIndex + 1) % filteredQuestions.length;
    }

    function resetQuiz() {
      if (confirm('Reset all quiz progress?')) {
        quizStats = { correct: 0, total: 0, bestStreak: 0, currentStreak: 0, byCategory: {} };
        answeredQuestions = [];
        DB.setOne('quizStats', quizStats);
        DB.set('answeredQuestions', []);
      }
    }

    function updateQuizStats() {
      document.getElementById('quizScore').textContent = quizStats.correct;
      document.getElementById('quizTotal').textContent = quizStats.total;
      document.getElementById('quizAccuracy').textContent = quizStats.total > 0 ? Math.round((quizStats.correct / quizStats.total) * 100) + '%' : '--%';
      document.getElementById('quizStreak').textContent = quizStats.bestStreak;

      // Update category progress
      const cats = ['compute', 'storage', 'database', 'security', 'networking', 'pricing'];
      cats.forEach(cat => {
        const stats = quizStats.byCategory[cat] || { correct: 0, total: 0 };
        const pct = stats.total > 0 ? (stats.correct / stats.total) * 100 : 0;
        const progEl = document.getElementById('prog' + cat.charAt(0).toUpperCase() + cat.slice(1));
        const statEl = document.getElementById('stat' + cat.charAt(0).toUpperCase() + cat.slice(1));
        if (progEl) {
          progEl.style.width = pct + '%';
          progEl.className = 'progress-fill ' + (pct >= 70 ? 'good' : pct >= 40 ? 'medium' : 'low');
        }
        if (statEl) statEl.textContent = `${stats.correct}/${stats.total}`;
      });
    }

    function updateWeakAreas() {
      const container = document.getElementById('weakAreas');
      const wrongByCat = {};
      answeredQuestions.filter(a => !a.correct).forEach(a => {
        wrongByCat[a.cat] = (wrongByCat[a.cat] || 0) + 1;
      });

      const weakCats = Object.entries(wrongByCat).sort((a, b) => b[1] - a[1]).slice(0, 3);
      const catLabels = { compute: 'ğŸ–¥ï¸ Compute', storage: 'ğŸ’¾ Storage', database: 'ğŸ—„ï¸ Database', security: 'ğŸ” Security', networking: 'ğŸŒ Networking', pricing: 'ğŸ’° Pricing' };

      if (weakCats.length === 0) {
        container.innerHTML = '<div class="insight positive">No weak areas yet - keep practicing!</div>';
      } else {
        container.innerHTML = weakCats.map(([cat, count]) => `
          <div class="data-item" style="cursor:pointer" onclick="setCategory('${cat}')">
            <div class="data-item-info">
              <div class="data-item-title">${catLabels[cat]}</div>
              <div class="data-item-meta">${count} incorrect answers - Click to practice</div>
            </div>
            <div class="data-item-value" style="color:var(--danger)">${count}</div>
          </div>
        `).join('');
      }
    }

    // Dashboard
    function updateDashboard() {
      const moods = DB.get('moods');
      const sleeps = DB.get('sleeps');
      const exercises = DB.get('exercises');
      const meds = DB.get('medications');

      const today = new Date().toDateString();
      const todayMood = moods.find(m => new Date(m.date).toDateString() === today);
      const todaySleep = sleeps.find(s => new Date(s.date).toDateString() === today);
      const todayExercise = exercises.filter(e => new Date(e.date).toDateString() === today).reduce((a, e) => a + e.duration, 0);
      const medsTaken = meds.filter(m => m.taken).length;
      const medsTotal = meds.length;

      // Stats
      document.getElementById('statMood').textContent = todayMood ? todayMood.mood + '/10' : '--';
      document.getElementById('statSleep').textContent = todaySleep ? todaySleep.hours + 'h' : '--';
      document.getElementById('statExercise').textContent = todayExercise + 'min';
      document.getElementById('statMeds').textContent = medsTotal > 0 ? `${medsTaken}/${medsTotal}` : '--';

      // Calculate wellness score
      let score = 0;
      let maxScore = 0;

      if (todayMood) { score += todayMood.mood * 2.5; maxScore += 25; }
      if (todaySleep) { score += Math.min(todaySleep.hours / 8 * 25, 25); maxScore += 25; }
      if (todayExercise > 0) { score += Math.min(todayExercise / 30 * 25, 25); maxScore += 25; }
      if (medsTotal > 0) { score += (medsTaken / medsTotal) * 25; maxScore += 25; }

      const wellness = maxScore > 0 ? Math.round((score / maxScore) * 100) : 0;
      const circle = document.getElementById('wellnessCircle');
      document.getElementById('wellnessScore').textContent = wellness;
      circle.className = 'score-circle ' + (wellness >= 70 ? 'score-good' : wellness >= 40 ? 'score-medium' : 'score-low');

      // Progress bars
      const setProgress = (id, value, max) => {
        const pct = Math.min(100, (value / max) * 100);
        document.getElementById(id).style.width = pct + '%';
        document.getElementById(id).className = 'progress-fill ' + (pct >= 70 ? 'good' : pct >= 40 ? 'medium' : 'low');
      };

      if (moods.length > 0) setProgress('progressMood', moods.slice(0, 7).reduce((a, m) => a + m.mood, 0) / Math.min(7, moods.length), 10);
      if (sleeps.length > 0) setProgress('progressSleep', sleeps.slice(0, 7).reduce((a, s) => a + s.hours, 0) / Math.min(7, sleeps.length), 8);
      if (exercises.length > 0) setProgress('progressExercise', exercises.filter(e => new Date(e.date) > new Date(Date.now() - 7*24*60*60*1000)).reduce((a, e) => a + e.duration, 0) / 7, 30);
      if (medsTotal > 0) setProgress('progressMeds', medsTaken, medsTotal);

      // Insights
      const insights = [];
      if (todayMood && todayMood.mood >= 7) insights.push({ type: 'positive', text: 'ğŸŒŸ Great mood today! Keep it up!' });
      if (todayMood && todayMood.mood <= 3) insights.push({ type: 'negative', text: 'ğŸ’™ Tough day? Remember, it\'s okay to not be okay.' });
      if (todaySleep && todaySleep.hours >= 7) insights.push({ type: 'positive', text: 'ğŸ˜´ Excellent sleep! Well rested.' });
      if (todaySleep && todaySleep.hours < 6) insights.push({ type: 'warning', text: 'âš ï¸ You need more sleep. Aim for 7-8 hours.' });
      if (todayExercise >= 30) insights.push({ type: 'positive', text: 'ğŸ’ª You hit your exercise goal today!' });
      if (todayExercise === 0) insights.push({ type: 'warning', text: 'ğŸƒ No exercise logged. A short walk counts!' });
      if (medsTotal > 0 && medsTaken < medsTotal) insights.push({ type: 'warning', text: 'ğŸ’Š Remember to take all your medications.' });
      if (medsTotal > 0 && medsTaken === medsTotal) insights.push({ type: 'positive', text: 'âœ… All medications taken!' });

      if (insights.length === 0) insights.push({ type: 'info', text: 'ğŸ“Š Start logging data to see personalized insights!' });

      document.getElementById('insightsList').innerHTML = insights.map(i => `<div class="insight ${i.type}">${i.text}</div>`).join('');
    }

    // Initialize
    loadMoodHistory();
    loadMedications();
    loadSleepData();
    loadExerciseData();
    updateDashboard();
    moodEmoji.textContent = moodEmojis[4];
  </script>
</body>
</html>
